## 数据库安全性



### 1、概述

安全标准：TCSEC和CC（最具影响力）

TCSEC：D、C（C1【**DAC**】、C2【安全产品的最低档】）、B（B1【真正意义上的安全产品、**MAC**】、B2、B3）、A

CC：EAL(1~7)

### 2、数据库安全性控制

![image-20220319144352558](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220319144352558.png)

![image-20220319144407829](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220319144407829.png)

#### 存取控制

1、主要包括定义用户权限和合法权限检查两部分

2、定义用户权限和合法权限检查机制一起组成了数据库管理系统的存取控制子系统。

#### 自主存取控制

1、用户对于不同的数据库对象有不同的存取权限，不同的用户对于同一对象也有不同的权限，而且用户还可将其拥有的存取权限转授给其他用户。

2、主要通过SQL的GRANT和REVOKE语句来实现

3、用户权限由**数据库对象**和**操作类型**组成

4、关系型数据库中，存取控制的对象不仅有数据本身，还有数据库模式

##### 1、GRANT

```sql
grant <权限>[,<权限>]...
on <对象类型><对象名>[,<对象类型><对象名>]...
to <用户>[,<用户>]
[with grant option];# 如果指定了，获得该权限的用户还可以把这种权限再授予其他用户
```

1、发出该语句的可以是数据库对象创建者，也可以是拥有该权限的用户；接受权限的也可以是一个或多个具体用户，还可以是PUBLIC（全体用户）

2、不允许循环授权

![image-20220319145601297](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220319145601297.png)

##### 2、REVOKE

```sql
revoke <权限>[,<权限>]...
on <对象类型><对象名>[,<对象类型><对象名>]...
from <用户>[,<用户>]...[cascade|restrict];
```

##### 3、创建数据库模式的权限

1、对**创建数据库模式一类的数据库对象的授权**则由**数据库管理员**在创建用户时实现。

2、

```sql
create user <username> [with] [DBA|RESOURCE|CONNECT];
```

（1）只有系统的**超级用户**才有权创建一个新的数据库用户。

（2）三种权限

- （默认）connect：只能登录数据库，等待其他用户授予他相应的权限
- resource：能创建基本表和视图，成为所创建对象的属主
- dba（超级用户）：啥权限都有

#### 数据库角色

1、数据库角色是被命名的一组和数据库操作相关的权限，角色是权限的集合

##### 1、角色的创建

```sql
create role <角色名>
```

##### 2、给角色授权

```sql
grant <权限>[,<权限>]...
on <对象类型>对象名
to <角色>[,<角色>]...
```

##### 3、将一个角色赋予其他的角色或用户

```sql
grant <角色>[,<角色>]...
to <角色>[,<用户>]...
[with admin option]; # 是否可以将角色再授予 
```

授予者是**角色的创建者**，或者是拥有在这个角色上的 `admin option`

##### 4、角色权限的收回

```sql
revoke <权限>[,<权限>]...
on <对象类型><对象名>
from <角色>[,<角色>];
```

#### 强制存取控制方法

1、数据库管理系统所管理的全部实体被分为主体和客体

2、**主体**是系统中的活动实体，既包括实际用户，也包括代表用户的各进程；**客体**是系统中的被动实体，即指数据和数据库对象等。

3、**敏感度标记**：TS（绝密）>= S（机密）>= C（可信）>= P（公开）

主体的敏感度标记称为**许可证级别**；客体的敏感度标记称为**密级**

4、<font color="red">规则：</font>

- 仅当主体的许可证级别>=客体的密级时，主体才能读取相应的客体
- **仅当主体的许可证级别<=客体的密级时，主体才能写相应的客体**

> 其中对于规则2的解释：
>
> 就是如果高许可证级别的主体可以向低级别密级的客体写数据的话，就会导致数据的向下泄露。

5、MAC是对数据进行密级标记使得标记和数据是一个不可分的整体，只有符合密级标记要求的用户才可以操纵数据，从而提供更高级别的安全性。

![image-20220319161550380](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220319161550380.png)

